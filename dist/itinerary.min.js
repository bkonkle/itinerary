!function(t,e){"function"==typeof define&&define.amd?define(underscorefactory):"object"==typeof exports?module.exports=e(require("underscore")):t.Itinerary=e(t._)}(this,function(t){var e=function(e){return{underscore:t}[e]};return(e=function n(t,r,i){function s(c,u){if(!r[c]){if(!t[c]){var a="function"==typeof e&&e;if(!u&&a)return a(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+c+"'")}var f=r[c]={exports:{}};t[c][0].call(f.exports,function(e){var n=t[c][1][e];return s(n?n:e)},f,f.exports,n,t,r,i)}return r[c].exports}for(var o="function"==typeof e&&e,c=0;c<i.length;c++)s(i[c]);return s}({F9UmcE:[function(t,e){"use strict";e.exports=t("./lib/router")},{"./lib/router":4}],itinerary:[function(t,e){e.exports=t("F9UmcE")},{}],3:[function(t,e){"use strict";var n,r,i=t("underscore"),s=Array.prototype.slice,o={on:function(t,e,r){if(!n(this,"on",t,[e,r])||!e)return this;this._events||(this._events={});var i=this._events[t]||(this._events[t]=[]);return i.push({callback:e,context:r,ctx:r||this}),this},once:function(t,e,r){if(!n(this,"once",t,[e,r])||!e)return this;var s=this,o=i.once(function(){s.off(t,o),e.apply(this,arguments)});return o._callback=e,this.on(t,o,r)},off:function(t,e,r){var s,o,c,u,a,f,l,h;if(!this._events||!n(this,"off",t,[e,r]))return this;if(!t&&!e&&!r)return this._events=void 0,this;for(u=t?[t]:i.keys(this._events),a=0,f=u.length;f>a;a++)if(t=u[a],c=this._events[t]){if(this._events[t]=s=[],e||r)for(l=0,h=c.length;h>l;l++)o=c[l],(e&&e!==o.callback&&e!==o.callback._callback||r&&r!==o.context)&&s.push(o);s.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=s.call(arguments,1);if(!n(this,"trigger",t,e))return this;var i=this._events[t],o=this._events.all;return i&&r(i,e),o&&r(o,arguments),this},stopListening:function(t,e,n){var r=this._listeningTo;if(!r)return this;var s=!e&&!n;n||"object"!=typeof e||(n=this),t&&((r={})[t._listenId]=t);for(var o in r)t=r[o],t.off(e,n,this),(s||i.isEmpty(t._events))&&delete this._listeningTo[o];return this}},c=/\s+/;n=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(c.test(n)){for(var s=n.split(c),o=0,u=s.length;u>o;o++)t[e].apply(t,[s[o]].concat(r));return!1}return!0},r=function(t,e){var n,r=-1,i=t.length,s=e[0],o=e[1],c=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,s);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,s,o);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,s,o,c);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}};var u={listenTo:"on",listenToOnce:"once"};i.each(u,function(t,e){o[e]=function(e,n,r){var s=this._listeningTo||(this._listeningTo={}),o=e._listenId||(e._listenId=i.uniqueId("l"));return s[o]=e,r||"object"!=typeof n||(r=this),e[t](n,r,this),this}}),o.bind=o.on,o.unbind=o.off,e.exports=o},{}],4:[function(t,e){"use strict";var n=t("underscore"),r=t("./events"),i=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},s=/\((.*?)\)/g,o=/(\(\?)?:\w+/g,c=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(i.prototype,r,{initialize:function(){},route:function(t,e,r){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(e)&&(r=e,e=""),r||(r=this[e]);var i=this;return Backbone.history.route(t,function(n){var s=i._extractParameters(t,n);i.execute(r,s),i.trigger.apply(i,["route:"+e].concat(s)),i.trigger("route",e,s),Backbone.history.trigger("route",i,e,s)}),this},execute:function(t,e){t&&t.apply(this,e)},navigate:function(t,e){return Backbone.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(u,"\\$&").replace(s,"(?:$1)?").replace(o,function(t,e){return e?t:"([^/?]+)"}).replace(c,"([^?]*?)"),new RegExp("^"+t+"(?:\\?(.*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return n.map(r,function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null})}}),e.exports=i},{"./events":3}],5:[function(){},{}]},{},["F9UmcE"]))("itinerary")});